<!DOCTYPE html>
<html>
  <head>
  <title>
    
    Connecting a remote MongoDB database with R/Shiny - Julian Stanley
    
  </title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Julian Stanley" />
  <link rel="shortcut icon" type="image/x-icon" href="https://julianstanley.com/img/favicon.ico">

  
  
  
  
  
  <link rel="stylesheet" href="https://julianstanley.com/style.min.63822a3257eaab81b78b5d5fc6e45112b4ca6f4c287acdd1f19760310b3dcb19.css" integrity="sha256-Y4IqMlfqq4G3i11fxuRRErTKb0woes3R8ZdgMQs9yxk=">
  
  
  
  <link rel="stylesheet" href="https://julianstanley.com/style-dark.min.0a647fb6c07e04b77b54fa0515d0a683d39ecdb251dba960fe1f966f7ff36fc2.css" media="(prefers-color-scheme: dark)"
    integrity="sha256-CmR/tsB&#43;BLd7VPoFFdCmg9OezbJR26lg/h&#43;Wb3/zb8I=">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdn.rawgit.com/jpswalsh/academicons/master/css/academicons.min.css">

  
  

  <meta property="og:title" content="Connecting a remote MongoDB database with R/Shiny" />
<meta property="og:description" content="While making a Shiny App for a lab project (Sensor Overlord), I wanted to create a feature where users could input sensor data into a database, where it could be accessible to other users.
I decided to give MongoDB a shot, mostly becuase of the free hosting services available on MongoDB&rsquo;s website.
And it was actually extremely straightforward. There are great resources available online, like the mongolite user manual and the shiny persistent data storage page." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://julianstanley.com/blog/mongo_rshiny/" />
<meta property="article:published_time" content="2019-04-24T00:00:00+00:00" />
<meta property="article:modified_time" content="2019-04-24T00:00:00+00:00" />
<meta itemprop="name" content="Connecting a remote MongoDB database with R/Shiny">
<meta itemprop="description" content="While making a Shiny App for a lab project (Sensor Overlord), I wanted to create a feature where users could input sensor data into a database, where it could be accessible to other users.
I decided to give MongoDB a shot, mostly becuase of the free hosting services available on MongoDB&rsquo;s website.
And it was actually extremely straightforward. There are great resources available online, like the mongolite user manual and the shiny persistent data storage page.">


<meta itemprop="datePublished" content="2019-04-24T00:00:00&#43;00:00" />
<meta itemprop="dateModified" content="2019-04-24T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="426">



<meta itemprop="keywords" content="projects,R,shiny,technical," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:image" content="https://julianstanley.com//img/avataaars.png"/>
<meta name="twitter:title" content="Connecting a remote MongoDB database with R/Shiny"/>
<meta name="twitter:description" content="While making a Shiny App for a lab project (Sensor Overlord), I wanted to create a feature where users could input sensor data into a database, where it could be accessible to other users.
I decided to give MongoDB a shot, mostly becuase of the free hosting services available on MongoDB&rsquo;s website.
And it was actually extremely straightforward. There are great resources available online, like the mongolite user manual and the shiny persistent data storage page."/>

  <!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
  <![endif]-->

  <!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
  <![endif]-->

  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-109124750-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>
</head>
  <body>
    
  <h1>Connecting a remote MongoDB database with R/Shiny</h1>
  <header>
  
  <div class="avatar">
    <img class="avatarMask" src="https://julianstanley.com//img/avataaars.png" alt="">
    <a href="https://julianstanley.com/"><img class="avatar-border" src="https://julianstanley.com//img/avatar-border.svg" alt=""></a>
  </div>
  
  <h2><a class="author" href="https://julianstanley.com/">Julian Stanley</a></h2>
</header>

  
  
  
  <p class="date">April 24, 2019</p>
  
  
  
  <div id="tags">
    <ul>
      
        
        
          <li><a href="https://julianstanley.com/tags/projects/">projects</a></li>
        
      
        
        
          <li><a href="https://julianstanley.com/tags/r/">R</a></li>
        
      
        
        
          <li><a href="https://julianstanley.com/tags/shiny/">shiny</a></li>
        
      
        
        
          <li><a href="https://julianstanley.com/tags/technical/">technical</a></li>
        
      
    </ul>
  </div>
  
  
  <div id="contentBody">
    

<p>While making a Shiny App for a lab project (Sensor Overlord), I wanted to create
a feature where users could input sensor data into a database, where it could
be accessible to other users.</p>

<p>I decided to give MongoDB a shot, mostly becuase of the free hosting services
available on <a href="https://mongodb.com">MongoDB&rsquo;s website</a>.</p>

<p>And it was actually extremely straightforward. There are great resources
available online, like
<a href="https://jeroen.github.io/mongolite/">the mongolite user manual</a> and the
<a href="https://shiny.rstudio.com/articles/persistent-data-storage.html">shiny persistent data storage page</a>.</p>

<p>But it still took some troubleshooting on my part, so I wanted to share
my mongodb.com-specific guide.</p>

<h1 id="mongodb-com-free-cluster-setup-and-configuration">MongoDB.com free cluster setup and configuration</h1>

<ol>
<li>Create an account on cloud.mongodb.com.</li>
<li>Set up a basic (free) cluster, give it a name. I named mine SensorOverlordCluster.</li>
<li>On the main cluster page, navigate to the &ldquo;Security&rdquo; tab and add a user.

<ul>
<li>I&rsquo;ll give mine the username <em>myself</em> and the password <em>letmein</em>.</li>
</ul></li>
<li>Back on the &ldquo;Overview&rdquo; tab, click the name of your cluster.</li>
<li>In the new screen that appears, click the &ldquo;Collections&rdquo; tab.</li>
<li>Create a new database and write down the database and collection name.
For mine, the database name was <em>sensordb</em> and the collection name was <em>responses</em>.</li>
</ol>

<h1 id="writing-and-reading-mongodb-from-r">Writing and reading MongoDB from R</h1>

<ol>
<li>Install the mongolite package

<ul>
<li>I&rsquo;m running Ubuntu and had to run
<code>sudo apt-get install libssl-dev libsasl2-dev</code> to get the dependencies I
needed for my system. See the
<a href="https://jeroen.github.io/mongolite/">the mongolite user manual</a> for
more info specific to your system.</li>
<li><code>install.packages(&quot;mongolite&quot;)</code> for the CRAN version or <code>devtools::install_
github(&quot;jeroen/mongolite&quot;)</code> for the development version.</li>
</ul></li>

<li><p>Save some data to your database. I&rsquo;ll put the code below.</p>

<ul>
<li><p>Note that the host should me mnopd.mongodb.net if you&rsquo;re using mongodb.net&rsquo;s
hosting service. If that doesn&rsquo;t work, check the base url that&rsquo;s given when
you click &ldquo;connect&rdquo; on the main overviewpage on cloud.mongodb.com,
and then click &ldquo;Connect Your Application&rdquo; and set your driver as C
version 1.9 or later. Your eventual url input should mimic that
&ldquo;connection string only&rdquo; field.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#66d9ef">options</span>(mongodb <span style="color:#f92672">=</span> <span style="color:#66d9ef">list</span>(
<span style="color:#e6db74">&#34;cluster&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;sensoroverlordcluster&#34;</span>,
<span style="color:#e6db74">&#34;host&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;mnopd.mongodb.net&#34;</span>,
<span style="color:#e6db74">&#34;username&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;myself&#34;</span>,
<span style="color:#e6db74">&#34;password&#34;</span> <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;letmein&#34;</span>
))

databaseName <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;sensordb&#34;</span>
collectionName <span style="color:#f92672">&lt;-</span> <span style="color:#e6db74">&#34;responses&#34;</span>

saveData <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>(data) {
<span style="color:#75715e"># Connect to the database</span>
db <span style="color:#f92672">&lt;-</span> mongo(collection <span style="color:#f92672">=</span> collectionName,
        url <span style="color:#f92672">=</span> <span style="color:#66d9ef">sprintf</span>(
            <span style="color:#e6db74">&#34;mongodb+srv://%s:%s@%s-%s/%s?retryWrites=true&#34;</span>,
            <span style="color:#66d9ef">options</span>()<span style="color:#f92672">$</span>mongodb<span style="color:#f92672">$</span>username,
            <span style="color:#66d9ef">options</span>()<span style="color:#f92672">$</span>mongodb<span style="color:#f92672">$</span>password,
            <span style="color:#66d9ef">options</span>()<span style="color:#f92672">$</span>mongodb<span style="color:#f92672">$</span>cluster,
            <span style="color:#66d9ef">options</span>()<span style="color:#f92672">$</span>mongodb<span style="color:#f92672">$</span>host,
            databaseName))
    
<span style="color:#75715e"># Insert the data into the mongo collection as a data.frame</span>
data <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">as.data.frame</span>(data)
db<span style="color:#f92672">$</span>insert(data)
}</code></pre></div></li>
</ul></li>
</ol>

<p>&nbsp;</p>

<ol>
<li><p>Once you use the <code>saveData(data)</code> function to save some data, you can
load it right back up!</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r">loadData <span style="color:#f92672">&lt;-</span> <span style="color:#66d9ef">function</span>() {
<span style="color:#75715e"># Connect to the database</span>
db <span style="color:#f92672">&lt;-</span> mongo(collection <span style="color:#f92672">=</span> collectionName,
            url <span style="color:#f92672">=</span> <span style="color:#66d9ef">sprintf</span>(
                <span style="color:#e6db74">&#34;mongodb+srv://%s:%s@%s/%s&#34;</span>,
                <span style="color:#66d9ef">options</span>()<span style="color:#f92672">$</span>mongodb<span style="color:#f92672">$</span>username,
                <span style="color:#66d9ef">options</span>()<span style="color:#f92672">$</span>mongodb<span style="color:#f92672">$</span>password,
                <span style="color:#66d9ef">options</span>()<span style="color:#f92672">$</span>mongodb<span style="color:#f92672">$</span>host,
                databaseName))
    
<span style="color:#75715e"># Read all the entries</span>
data_output <span style="color:#f92672">&lt;-</span> db<span style="color:#f92672">$</span>find()
data_output
}</code></pre></div></li>
</ol>

  </div>
  <footer>
  <p>
    &copy;
    <span id="copyright">
      <script>document.getElementById('copyright').appendChild(document.createTextNode(new Date().getFullYear()))</script>
    </span>
    Julian Stanley.
    Powered by <a href="https://gohugo.io/">Hugo</a>
    using the <a href="https://github.com/koirand/pulp/">pulp</a> theme.
  </p>
</footer>

  </body>
</html>
